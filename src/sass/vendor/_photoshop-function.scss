@use "sass:list";
@use "sass:math";
@use "sass:string";
@use "trig";

// --------------------------------------------------------
// Photoshop 轉換功能
// --------------------------------------------------------
// [Photoshop|PS] 的字距設定 1: 0.001em
// Photoshop Letter Tracking/1000 = letter-spacing in em
// Ref: https://martinwolf.org/before-2018/blog/2016/02/convert-typographic-properties-from-ps-to-css/
@function ps-letter-spacing($num) {
	@return $num / 1000 * 1em;
}


// Ref: https://github.com/kwaledesign/sass-shadows/blob/master/photoshop-shadows.scss
$ps-global-light: 120deg !default;
@function ps-shadow( $angle: $ps-global-light, $distance: 0, $spread: 0, $size: 0, $color: #000, $inner: false ) {
	// default to degrees, same as photoshop
	@if math.is-unitless($angle) {
		$angle: $angle * 1deg;
	}
  
	// compass has a bug converting degrees (fixed in Compass 0.12)
	// https://github.com/chriseppstein/compass/pull/666
	@if math.unit($angle) == 'deg' {
		// convert to radians to avoid issues
		$angle: ((180 - ($angle/1deg)) * trig.pi() / 180);
	}
	//TODO: other angle units, including rad, will cause issues
  
	// SASS doesn't do percentages cleanly
	@if not(math.is-unitless($spread)) and math.unit($spread) == '%' {
		// remove the percentage unit
		$spread: $spread/1%;
	} @else if $spread < 0 {
		// correct for passing the spread as a decimal
		$spread: $spread * 100;
	}
  
	$h-shadow: math.round(trig.cos($angle) * $distance);
	$v-shadow: math.round(trig.sin($angle) * $distance);
	$css-spread: $size * ($spread/100);
	$blur: $size - $css-spread;
	$inset: if($inner != false, 'inset', '');

	// @return ( $h-shadow $v-shadow $blur $css-spread $color unquote($inset) );
	@return ( $h-shadow $v-shadow $blur $color string.unquote($inset) );
}

@function ps-text-shadow( $angle: $ps-global-light, $distance: 0, $spread: 0, $size: 0, $color: #000 ) {
	$shadow: ps-shadow($angle, $distance, $spread, $size, $color);
	@return (list.nth($shadow, 1) list.nth($shadow, 2) list.nth($shadow, 3) list.nth($shadow, 5));
}

@function ps-glow($choke: 0, $size: 0, $color: #fff, $inner: false) {
	@return ps-shadow(0, 0, $choke, $size, $color, $inner);
}
